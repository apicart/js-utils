/** 
 * utils.js v1.0.0-alpha1 
 * (c) 2018-2019 Vladimír Macháček
 *  Released under the MIT License.
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";var s={forEach:function(e,t){var n,r,a,o,i;if(null!=e){if(Array.isArray(e)){if(!(r=e.length))return;for(n=0;n<r&&!1!==t(n,e[n]);n++);}else{if(!(o=(a=Object.keys(e)).length))return;for(n=0;n<o&&!1!==t(i=a[n],e[i]);n++);}return s}}};var t={firtsToUpper:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},generateHash:function(e,t){var n="";for(t=t||"abcdefghijklmnopqrstuvwxyz0123456789";e--;)n+=t.charAt(Math.floor(Math.random()*t.length));return n},sprintf:function(n,e){return s.forEach(e,function(e,t){-1!==["number","string"].indexOf(typeof t)&&(n=n.replace(new RegExp("%"+e+"%","g"),t))}),n}};function n(e){var t=typeof e;return"undefined"===t||null===e||"number"!==t&&("string"===t?!!e.length:"object"===t||Array.isArray(e)?Object.keys(e).length<1:void 0)}var a={isEmpty:n};var e={error:function(){return void 0!==console.error&&console.error.apply(null,Array.prototype.slice.call(arguments)),e},log:function(){return void 0!==console.log&&console.log.apply(null,Array.prototype.slice.call(arguments)),e},warn:function(){return void 0!==console.warn&&console.warn.apply(null,Array.prototype.slice.call(arguments)),e}};function r(e){return"object"==typeof e?JSON.stringify(e):""}var o={isJson:function(e){if("string"!=typeof e)return!1;try{JSON.parse(e)}catch(e){return!1}return!0},parse:i,stringify:r};function i(e){return o.isJson(e)?JSON.parse(e):{}}var c=Element.prototype;var u={addClass:function(n,e){return"string"==typeof e&&(e=e.split(" ")),s.forEach(e,function(e,t){n.classList.contains(t)||(n.className+=" "+t)}),n.className=n.className.trim(),u},findParent:function(e,t){for(var n=null;e=e.parentElement;)if(u.matches(e,t)){n=e;break}return n},matches:function(e,t){return c.matches?e.matches(t):!!c.msMatchesSelector&&e.msMatchesSelector(t)},on:function(t,e,o){return"string"==typeof t&&(t=t.split(" ")),"string"==typeof e&&(e=e.split(",")),s.forEach(e,function(e,a){s.forEach(t,function(e,t){var n,r;n=a,r=t,document.addEventListener(r,function(e){var t=e.target;if(t!==document){for(;t&&t!==this&&!u.matches(t,n);)t=t.parentNode;t&&t!==this&&(e.preventDefault(),o.call(t,e))}})})}),u},removeClass:function(e,t){return t=t.replace(" ","|"),e.className=e.className.replace(new RegExp(t,"g"),"").trim(),e.className=e.className.replace(/\s+/," "),u},trigger:function(e,r){return e instanceof Element&&(e=[e]),s.forEach(e,function(e,t){var n=new Event(r,{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(n)}),u}};function f(n,e){return"string"==typeof e&&(e=e.split(".")),1<e.length&&s.forEach(e,function(e,t){if("object"!=typeof n[t])return!1;n=n[t]}),delete n[e.pop()],l}var l={assign:function(e,t,n){"string"==typeof t&&(t=t.split("."));for(var r,a=t.length-1,o=0;o<a;++o)(r=t[o])in e||(e[r]={}),e=e[r];return e[t[a]]=n,l},copy:function(e){var n={};return s.forEach(e,function(e,t){n[e]=l.isObject(t)?l.copy(t):t}),n},delete:f,find:function(n,e){if(!e||!n||"object"!=typeof n)return null;"string"==typeof e&&(e=e.split("."));var r=!1;return 1<e.length&&s.forEach(e,function(e,t){return"object"==typeof n&&t in n?"object"==typeof n[t]&&void(n=n[t]):!(r=!0)}),r?null:n[e.pop()]},isObject:function(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e},merge:function(){var n={},e=Array.prototype.slice.call(arguments);return s.forEach(e,function(e,t){s.forEach(t,function(e,t){n[e]=e in n&&l.isObject(t)?l.merge(n[e],t):t})}),n},values:function(e){var n=[];return s.forEach(e,function(e,t){n.push(t)}),n}};function p(e,t){return l.assign(A,e,t),localStorage.setItem(y,o.stringify(A)),M}function g(e){e=e||!1;var t=document.querySelectorAll(e?m:m+":not(["+v+"])");return s.forEach(t,function(e,t){var n=t.getAttribute(d);if(n){var r=l.find(A,n);if(r){var a=t.getAttribute(d+"-if"),o=t.tagName.toLowerCase();if(-1<h.indexOf(o)){if(a===E&&t.value)return;"input"===o&&"radio"===t.getAttribute("type")&&t.getAttribute("name")?document.querySelector('[name="'+t.getAttribute("name")+'"][value="'+r+'"]').checked=!0:t.value=r}else{if(a===E&&t.innerHTML.trim())return;t.innerHTML=r}t.setAttribute(v,!0)}}}),M}u.on("change",m,function(){p(this.getAttribute(d),this.value)}),document.addEventListener("DOMContentLoaded",function(){g()});var d="data-bind",h=["select","input"],y="apicart_data_binder_data",m="["+d+"]",v="data-bound",E="empty",b=localStorage.getItem(y),A=b?i(b):{},M={addData:p,bindData:g,removeData:function(e){return e&&f(A,e),localStorage.setItem(y,r(A)),M}};var w={},j={addListener:function(n,e,r,a){return a=a||!1,"string"==typeof e&&(e=e.split(" ")),s.forEach(e,function(e,t){t in w||(w[t]={}),w[t][n]={callback:r,singleAction:a}}),j},dispatchEvent:function(e,r){return Array.isArray(r)||(r=[r]),"string"==typeof e&&(e=e.split(" ")),s.forEach(e,function(e,n){n in w&&s.forEach(w[n],function(e,t){t.singleAction&&j.removeListener(e,n),t.callback.apply(null,r)})}),j},removeListener:function(n,e){return"string"==typeof e&&(e=e.split(" ")),s.forEach(e,function(e,t){delete w[t][n]}),j}};var S="apicart_flash_messages",N={addMessage:function(e,t){t=t||"info";var n=N.getMessages();return t in n||(n[t]=[]),n[t].push(e),localStorage.setItem(S,o.stringify(n)),N},getMessages:function(){var e=localStorage.getItem(S);return e=e?o.parse(e):{}},hasMessages:function(e){var t=N.getMessages();return e?!n(t[e]):!n(t)},processMessages:function(r,n){var e;return"string"==typeof n&&N.hasMessages(n)?(e=N.getMessages(),s.forEach(e[n],function(e,t){r(t,n)})):N.hasMessages()&&(e=N.getMessages(),s.forEach(e,function(n,e){a.isEmpty(e)||s.forEach(e,function(e,t){r(t,n)})})),localStorage.setItem(S,o.stringify({})),N}};var O={getQueryParameter:function(e,t){t=t||window.location.href,e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}};window["undefined"==typeof utilsAlias?"Utils":utilsAlias]={ajax:function(e){var n={async:!0,cache:!0,data:{},headers:{},method:"get",timeout:5e3,url:"",withCredentials:!1,start:function(){},complete:function(){}};s.forEach(e,function(e,t){n[e]=t}),n.cache||(n.url+=-1===n.url.indexOf("?")?"?":"&",n.url+=t.generatehash(10));var r=new XMLHttpRequest;r.open(n.method,n.url,n.async),n.async&&0<n.timeout&&(r.timeout=n.timeout),a.isEmpty(n.headers)||s.forEach(n.headers,function(e,t){r.setRequestHeader(e,t)}),r.onreadystatechange=function(){2===r.readyState?n.start(r):4===r.readyState&&n.complete(r)},a.isEmpty(n.data)?r.send():r.send(n.data)},console:e,dataBinder:M,dom:u,eventDispatcher:j,flashMessages:N,json:o,loops:s,objects:l,strings:t,url:O,validators:a}});
